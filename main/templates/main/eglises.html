{% extends 'main/base.html' %}
{% load static %}

{% block extra_css %}
<style>
    /* Styles pour l'en-tête amélioré */
    .header-container {
        position: relative;
    }
    
    .header-container::before {
        content: '';
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57, #ff9ff3, #54a0ff);
        border-radius: 25px;
        z-index: -1;
        animation: gradient-animation 15s ease infinite;
        background-size: 400% 400%;
    }
    
    @keyframes gradient-animation {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    
    .icon-container {
        transition: all 0.3s ease;
    }
    
    .icon-container:hover {
        transform: scale(1.1) rotate(5deg);
    }
    
    .subtitle-badge {
        transition: all 0.3s ease;
    }
    
    .subtitle-badge:hover {
        transform: translateX(5px);
    }
    
    /* Animation pour les badges */
    .badge {
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .badge:hover {
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    /* Styles pour la fonctionnalité de recherche */
    mark {
        padding: 0.1em 0.2em;
        border-radius: 3px;
    }
    
    .search-container {
        background-color: #f8f9fa;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    #searchInput:focus {
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        border-color: #86b7fe;
    }
    
    #resultCount {
        transition: all 0.3s ease;
    }
    
    /* Animation pour le spinner de recherche */
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    #searchSpinner {
        animation: spin 1s linear infinite;
    }

    /* Image d'entête pour le formulaire Église */
    .header-eglise-img {
        height: 42px;
        width: 42px;
        object-fit: cover;
        border-radius: 8px;
        border: 2px solid rgba(255,255,255,.9);
        box-shadow: 0 2px 6px rgba(0,0,0,.25);
        display: inline-block;
    }
    
    /* Styles pour le tableau des églises */
    .table-eglises {
        table-layout: fixed;
        width: 100%;
    }
    
    .table-eglises th, .table-eglises td {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: 150px; /* Limiter la largeur maximale */
    }
    
    /* Augmenter la taille de la cellule Nom */
    .table-eglises .col-nom {
        min-width: 250px;
        max-width: 300px;
        width: 20%;
    }
    
    /* S'assurer que les boutons d'action restent sur la même ligne */
    .table-eglises .d-flex {
        flex-wrap: nowrap;
        justify-content: center;
    }
    
    /* Animation pour le modal de confirmation */
    @keyframes shake {
        0% { transform: translateX(0); }
        20% { transform: translateX(-10px); }
        40% { transform: translateX(10px); }
        60% { transform: translateX(-5px); }
        80% { transform: translateX(5px); }
        100% { transform: translateX(0); }
    }
    
    .shake-animation {
        animation: shake 0.5s ease-in-out;
    }
    
    /* Styles pour le modal de confirmation de suppression */
    #modalConfirmationSuppression {
        z-index: 9999;
    }
    
    /* Styles pour s'assurer que le modal de confirmation est toujours visible */
    #modalConfirmationSuppression .modal-content {
        transform: scale(1.05);
        transition: transform 0.3s ease;
    }
    
    #modalConfirmationSuppression.show .modal-content {
        transform: scale(1);
    }
    
    /* Style pour les boutons du modal de confirmation */
    #modalConfirmationSuppression .btn {
        transition: all 0.2s ease;
        min-width: 150px;
    }
    
    #modalConfirmationSuppression .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .confirmation-visible .modal-dialog {
        box-shadow: 0 0 20px rgba(220, 53, 69, 0.8); /* Ombre rouge autour du modal */
        transform: scale(1.03); /* Légèrement plus grand pour attirer l'attention */
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    
    .confirmation-visible .modal-content {
        border: 2px solid #dc3545; /* Bordure rouge */
    }
    
    #modalConfirmationSuppression .modal-header {
        background-color: #dc3545 !important;
        color: white !important;
        font-weight: bold;
    }
    
    /* Overlay personnalisé pour le modal de confirmation */
    #confirmationOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 9998; /* Juste en dessous du modal */
        display: none;
    }
    
    /* Largeurs spécifiques pour chaque colonne */
    .table-eglises .col-nom { width: 15%; }
    .table-eglises .col-pays { width: 7%; }
    .table-eglises .col-ville { width: 10%; }
    .table-eglises .col-quartier { width: 10%; }
    .table-eglises .col-pasteur { width: 12%; }
    .table-eglises .col-telephone { width: 10%; }
    .table-eglises .col-email { width: 12%; }
    .table-eglises .col-date { width: 8%; }
    .table-eglises .col-association { width: 6%; }
    .table-eglises .col-membres { width: 5%; }

    
    /* Ajouter un tooltip pour voir le contenu complet au survol */
    .table-eglises td[title] {
        cursor: help;
    }
    
    /* Style pour le bouton Église avec belle icône */
    .btn-eglise-submit {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        padding: 12px 30px;
        font-weight: 600;
        font-size: 1rem;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
    }
    
    .btn-eglise-submit:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    
    .btn-eglise-submit i.fa-church {
        font-size: 1.2rem;
        animation: churchBounce 2s ease-in-out infinite;
    }
    
    @keyframes churchBounce {
        0%, 100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.15);
        }
    }

    .error-message {
        color: #dc3545;
        font-weight: bold;
        padding: 10px;
        margin-bottom: 20px;
        border-left: 5px solid #dc3545;
        background-color: rgba(220, 53, 69, 0.1);
        border-radius: 0 4px 4px 0;
    }
    
    /* Défilement horizontal des tableaux Églises */
    .table-eglises {
        /* Forcer une largeur minimale pour déclencher la barre horizontale si le conteneur est plus petit */
        min-width: 1200px;
        table-layout: auto !important; /* éviter la compression excessive des colonnes */
        width: auto; /* laisser la table occuper sa largeur de contenu */
    }
    /* S'assurer que le conteneur permet le scroll horizontal */
    .table-responsive {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch;
    }

    /* En-tête du formulaire: suppression de l'image décorative derrière le titre */
    .hero-card {
        position: relative;
        overflow: hidden;
    }
    .hero-card::after {
        content: none !important; /* désactive tout pseudo-élément décoratif */
        background: none !important;
    }
    .hero-card > * { position: relative; z-index: 1; }
</style>

<!-- (Supprimé) Inclusions XLSX/jsPDF/autoTable et export-functions.js -->
</head>
{% endblock %}

{% block title %}Enregistrement d'église - Gestion église{% endblock %}

{% block content %}
<!-- Overlay pour le modal de confirmation -->
<!div id="confirmationOverlay"></div>

<div class="page-content" style="position: relative; min-height: 100vh;">
    <div style="position: fixed; left: 0; bottom: 0; width: 100vw; height: auto; min-height: 40vh; z-index: 0; pointer-events: none;">
        <img src="{% static 'main/images/hero/fond1.jpg' %}" alt="Fond bas" style="width: 100vw; height: auto; display: block; object-fit: cover; object-position: bottom;">
    </div>
    <div class="container" style="position: relative; z-index: 2;">
        <!-- En-tête compact du formulaire d'enregistrement d'église -->
        <div class="header-container mb-3">
            <!-- Carte principale de l'en-tête -->
            <div class="card shadow border-0 hero-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; overflow: hidden;">
                <div class="card-body p-3">
                    <div class="row align-items-center">
                        <!-- Section titre et description -->
                        <div class="col-lg-8">
                            <div class="d-flex align-items-center mb-2">
                                <div class="icon-container me-3" style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: px; backdrop-filter: blur(10px);">
                                    <img src="{% static 'main/images/LogoEg.png' %}" alt="Église" class="header-eglise-img">
                                </div>
                                <div class="text-end ms-auto">
                                    <h1 class="text-white mb-1 text-end" style="font-size: 2.2rem; font-weight: 700; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); white-space: nowrap;">
                                        Formulaire d'Enregistrement d'Église
                                    </h1>
                                    <div class="subtitle-badge" style="background: rgba(255,255,255,0.15); padding: 6px 12px; border-radius: 20px; backdrop-filter: blur(10px); display: inline-block;">
                                        <p class="mb-0" style="color: white;">
                                            <i class="fas fa-star me-1" style="color: #ffd700; font-size: 0.8rem;"></i>
                                            <span style="font-size: 0.8rem; white-space: nowrap; font-style: italic; color: white;">Enregistrez une nouvelle église dans le réseau de l'église Pentecôte Alléluia de Guinée</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                </div>
                
                <!-- Décoration en bas de la carte -->
                <div style="height: 4px; background: linear-gradient(90deg, #ffd700, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);">
                </div>
            </div>
            
            <!-- Ligne de séparation décorative -->
            <div class="separator-line mt-2 mb-3" style="height: 1px; background: linear-gradient(90deg, transparent, #667eea, #764ba2, transparent); border-radius: 1px;">
            </div>
        </div>
        
        <!-- Affichage des messages -->
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'error' and "Le champ" in message|stringformat:"s" %}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert" style="border-left: 5px solid #721c24; font-weight: bold; color: #721c24;">
                        <i class="fas fa-exclamation-triangle"></i> {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% else %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}
        
        <div class="content-section shadow-sm rounded p-4 border border-light" style="background-color: transparent;">
            <!-- Message d'erreur pour les champs obligatoires -->
            <div id="validationErrorMessage" class="alert alert-danger d-none" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong>Erreur:</strong> <span id="errorText">une erreur s'est produite lors de l'enregistrement</span>
            </div>
            
            <form method="post" class="needs-validation" enctype="multipart/form-data" novalidate id="egliseForm">
                {% csrf_token %}
                
                <!-- Section 1: Informations sur l'église -->
                <div class="form-section mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="section-icon bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                            <i class="fas fa-info-circle text-primary fa-2x"></i>
                        </div>
                        <h4 class="section-title text-primary mb-0">1. Informations sur l'église</h4>
                    </div>
                    
                    <!-- Ligne 1: Nom de l'église, Pays, Ville -->
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="nom" class="form-label fw-bold required-field">Nom de l'église</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-church text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="nom" name="nom" value="{{ form_data.nom }}" list="eglises-list" placeholder="Sélectionnez ou saisissez un nom" required>
                            </div>
                            <datalist id="eglises-list">
                                <option value="Alléluia Bellevue">
                                <option value="Alléluia Enta">
                                <option value="Alléluia Cimenterie">
                                <option value="Alléluia Yattayah">
                                <option value="Alléluia Kagbelen">
                                <option value="Alléluia Kenendé">
                                <option value="Alléluia Kountia">
                                <option value="Alléluia Gomboyah">
                                <option value="Alléluia Coyah">
                                <option value="Alléluia Mangatha">
                                <option value="Alléluia Tanènè">
                                <option value="Alléluia Koba">
                                <option value="Alléluia Kissidougou">
                                <option value="Alléluia Guéckédou">
                                <option value="Alléluia Lola">
                                <option value="Alléluia Marela">
                                <option value="Alléluia Koundara">
                            </datalist>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="pays" class="form-label fw-bold required-field">Pays</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-globe-africa text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="pays" name="pays" value="{% if form_data.pays %}{{ form_data.pays }}{% else %}Guinée{% endif %}" required>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="ville" class="form-label fw-bold required-field">Ville</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-city text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="ville" name="ville" value="{{ form_data.ville }}" required>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ligne 2: Quartier, Pasteur en charge, Téléphone -->
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="quartier" class="form-label fw-bold">Quartier</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-map-marker-alt text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="quartier" name="quartier" value="{{ form_data.quartier }}">
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="responsable" class="form-label fw-bold required-field">Pasteur en charge</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user-tie text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="responsable" name="responsable" value="{{ form_data.responsable }}" list="liste-pasteurs" required>
                            </div>
                            <datalist id="liste-pasteurs">
                                <!-- Les options seront chargées dynamiquement via JavaScript -->
                            </datalist>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="telephone" class="form-label fw-bold required-field">Téléphone</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-phone text-primary"></i></span>
                                <input type="tel" class="form-control shadow-sm" id="telephone" name="telephone" value="{{ form_data.telephone }}" required>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ligne 3: Email, Date de fondation -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="email" class="form-label fw-bold">Email</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-envelope text-primary"></i></span>
                                <input type="email" class="form-control shadow-sm" id="email" name="email" value="{{ form_data.email }}">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="date_creation" class="form-label fw-bold required-field">Date de fondation de l'église</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-calendar-alt text-primary"></i></span>
                                <input type="date" class="form-control shadow-sm" id="date_creation" name="date_creation" value="{{ form_data.date_creation }}" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="nombre_membres" class="form-label fw-bold">Nombre de membres</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-users text-primary"></i></span>
                                <input type="number" class="form-control shadow-sm" id="nombre_membres" name="nombre_membres" value="{{ form_data.nombre_membres|default:0 }}" min="0">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="adresse" class="form-label fw-bold">Adresse</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-map text-primary"></i></span>
                                <input type="text" class="form-control shadow-sm" id="adresse" name="adresse" value="{{ form_data.adresse }}">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 2: Statut Juridique -->
                <div class="form-section mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="section-icon bg-success bg-opacity-10 p-3 rounded-circle me-3">
                            <i class="fas fa-gavel text-success fa-2x"></i>
                        </div>
                        <h4 class="section-title text-success mb-0">2. Statut Juridique</h4>
                    </div>
                    
                    <div class="row">

                        <div class="col-md-12 mb-3">
                            <label class="form-label fw-bold required-field">Association à but non lucratif ?</label>
                            <div class="mt-2">
                                <div class="form-check form-check-inline me-3">
                                    <input class="form-check-input shadow-sm" type="radio" name="est_association" id="association_oui" value="True" {% if form_data.est_association %}checked{% endif %} required>
                                    <label class="form-check-label" for="association_oui">
                                        <i class="fas fa-check-circle text-success me-1"></i>
                                        <span class="badge bg-dark">Oui</span>
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input shadow-sm" type="radio" name="est_association" id="association_non" value="False" {% if form_data.est_association == False %}checked{% endif %} required>
                                    <label class="form-check-label" for="association_non">
                                        <i class="fas fa-times-circle text-success me-1"></i>
                                        <span class="badge bg-dark">Non</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="detailsAssociation" style="display: none;">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="numero_autorisation" class="form-label fw-bold">Numéro d'enregistrement</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-hashtag text-success"></i></span>
                                    <input type="text" class="form-control shadow-sm" id="numero_autorisation" name="numero_autorisation" value="{{ form_data.numero_autorisation }}">
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="date_declaration" class="form-label fw-bold">Date d'enregistrement</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-calendar-check text-success"></i></span>
                                    <input type="date" class="form-control shadow-sm" id="date_enregistrement" name="date_enregistrement" value="{{ form_data.date_enregistrement }}">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 3: Activités et Services -->
                <div class="form-section mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="section-icon bg-info bg-opacity-10 p-3 rounded-circle me-3">
                            <i class="fas fa-tasks text-info fa-2x"></i>
                        </div>
                        <h4 class="section-title text-info mb-0">3. Activités et Services</h4>
                    </div>
                    
                    <div class="row">
                        <div class="col-12 mb-3">
                            <label class="form-label fw-bold text-dark fw-bold">Principales activités (cochez les cases applicables) :</label>
                            <div class="activities-grid">
                                <div class="form-check">
                                    <input class="form-check-input shadow-sm" type="checkbox" id="culte_hebdomadaire" name="activites[]" value="culte_hebdomadaire" {% if 'culte_hebdomadaire' in form_data.activites %}checked{% endif %}>
                                    <label class="form-check-label text-dark" for="culte_hebdomadaire">
                                        <i class="fas fa-pray text-info"></i> Culte hebdomadaire
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input shadow-sm" type="checkbox" id="ecole_dimanche" name="activites[]" value="ecole_dimanche" {% if 'ecole_dimanche' in form_data.activites %}checked{% endif %}>
                                    <label class="form-check-label text-dark" for="ecole_dimanche">
                                        <i class="fas fa-child text-info"></i> École du dimanche
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input shadow-sm" type="checkbox" id="actions_sociales" name="activites[]" value="actions_sociales" {% if 'actions_sociales' in form_data.activites %}checked{% endif %}>
                                    <label class="form-check-label text-dark" for="actions_sociales">
                                        <i class="fas fa-hands-helping text-info"></i> Actions sociales (soutien aux nécessiteux, etc.)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input shadow-sm" type="checkbox" id="etudes_bibliques" name="activites[]" value="etudes_bibliques" {% if 'etudes_bibliques' in form_data.activites %}checked{% endif %}>
                                    <label class="form-check-label text-dark" for="etudes_bibliques">
                                        <i class="fas fa-book-open text-info"></i> Études bibliques
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input shadow-sm" type="checkbox" id="autres_activites" name="activites[]" value="autres" {% if 'autres' in form_data.activites %}checked{% endif %}>
                                    <label class="form-check-label text-dark" for="autres_activites">
                                        <i class="fas fa-plus text-info"></i> Autres (précisez)
                                    </label>
                                </div>
                            </div>
                            
                            <div id="autresActivitesDetail" class="mt-3" {% if 'autres' not in form_data.activites %}style="display: none;"{% endif %}>
                                <label for="autres_activites_detail" class="form-label fw-bold">Précisez les autres activités :</label>
                                <textarea class="form-control shadow-sm" id="autres_activites_detail" name="autres_activites_detail" rows="3" placeholder="Décrivez les autres activités de l'église...">{{ form_data.autres_activites_detail }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 4: Pièces Jointes Requises -->
                <div class="form-section mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="section-icon bg-warning bg-opacity-10 p-3 rounded-circle me-3">
                            <i class="fas fa-paperclip text-warning fa-2x"></i>
                        </div>
                        <h4 class="section-title text-warning mb-0">4. Pièces Jointes Requises</h4>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="statuts_doc" class="form-label fw-bold">Copie des statuts et règlements intérieurs</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-paperclip text-warning"></i></span>
                                <input type="file" class="form-control shadow-sm" id="statuts_doc" name="statuts_doc" accept=".pdf,.doc,.docx">
                            </div>
                            <div class="form-text small">Formats acceptés : PDF, DOC, DOCX</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="pieces_identite_doc" class="form-label fw-bold">Copie de la pièce d'identité du responsable</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-id-card text-warning"></i></span>
                                <input type="file" class="form-control shadow-sm" id="pieces_identite_doc" name="pieces_identite_doc" accept=".pdf,.jpg,.jpeg,.png">
                            </div>
                            <div class="form-text small">Formats acceptés : PDF, JPG, PNG</div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 5: Déclaration -->
                <div class="form-section mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <div class="section-icon bg-purple bg-opacity-10 p-3 rounded-circle me-3">
                            <i class="fas fa-signature text-purple fa-2x"></i>
                        </div>
                        <h4 class="section-title text-purple mb-0">5. Déclaration</h4>
                    </div>
                    
                    <div class="declaration-section p-4 bg-light rounded-lg mb-4 border border-purple border-opacity-25 shadow-sm">
                        <div class="mb-3">
                            <p class="declaration-text text-dark mb-4">
                                Je soussigné(e), <input type="text" class="form-control d-inline-block shadow-sm" id="nom_declarant" name="nom_declarant" style="width: 200px; display: inline-block !important;" placeholder="Nom complet" value="{{ form_data.nom_declarant }}" required>, 
                                en ma qualité de <input type="text" class="form-control d-inline-block shadow-sm" id="qualite_declarant" name="qualite_declarant" style="width: 150px; display: inline-block !important;" placeholder="Qualité" value="{{ form_data.qualite_declarant }}" required> 
                                de l'église <input type="text" class="form-control d-inline-block shadow-sm" id="nom_eglise_inline" name="nom_eglise_inline" style="width: 200px; display: inline-block !important;" placeholder="Nom de l'église" value="{{ form_data.nom }}" required>, 
                                certifie que les informations fournies sont exactes et complètes.
                            </p>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="date_declaration" class="form-label fw-bold required-field">Date</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-calendar-day text-purple"></i></span>
                                    <input type="date" class="form-control shadow-sm" id="date_declaration" name="date_declaration" value="{{ form_data.date_declaration }}" required>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <button type="submit" class="btn btn-primary btn-eglise-submit"><i class="fas fa-church me-2"></i><i class="fas fa-save"></i> Enregistrer</button>
                        <button type="button" id="btnAnnuler" class="btn btn-secondary"><i class="fas fa-times"></i> Annuler</button>
                    </div>
                </div>
            </form>
        </div>

        <div class="content-section mt-5 bg-white shadow-lg rounded-4 border-0 overflow-hidden">
            <!-- En-tête avec dégradé magnifique -->
            <div class="header-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); padding: 12px 18px; margin: -15px -15px 15px -15px; position: relative; overflow: hidden;">
                <!-- Effet de particules en arrière-plan -->
                <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.3;"></div>
                
                <!-- Contenu principal de l'en-tête -->
            <div class="d-flex justify-content-between align-items-start position-relative">
                    <div class="header-title">
                        <h2 class="text-white mb-1 fw-bold" style="font-size: 2.2rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3); letter-spacing: -0.4px;">
                            <i class="fas fa-church me-2" style="color: #ffd700; font-size: 2rem; text-shadow: 0 2px 8px rgba(255,215,0,0.5);"></i>
                            Églises déjà enregistrées
                        </h2>
                        <p class="text-white-50 mb-2" style="font-size: 0.75rem; text-shadow: 0 1px 2px rgba(0,0,0,0.2); font-weight: 300;">
                            <i class="fas fa-map-marked-alt me-1" style="color: #4ecdc4; font-size: 0.7rem;"></i>
                            Réseau des églises affiliées à l'Église Pentecôte Alléluia de Guinée
                        </p>
                        
                        <!-- Barre de recherche intégrée -->
                        {% if eglises %}
                        <div class="row g-2 mb-1 align-items-center">
                            <div class="col-md-5">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text" style="background: rgba(255,255,255,0.9); border: none;"><i class="fas fa-search text-primary"></i></span>
                                    <input type="text" id="searchInput" class="form-control" placeholder="Rechercher une église..." aria-label="Rechercher" 
                                           style="background: rgba(255,255,255,0.95); border: none; font-size: 0.8rem;">
                                    <button class="btn btn-outline-light" type="button" id="clearSearch" title="Effacer la recherche" 
                                            style="background: rgba(255,255,255,0.9); border: none; color: #666;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <div class="d-flex align-items-center justify-content-end">
                                    <div id="searchSpinner" class="spinner-border spinner-border-sm text-white me-2 d-none" role="status">
                                        <span class="visually-hidden">Recherche en cours...</span>
                                    </div>
                                    <span id="resultCount" class="badge me-2" style="background: rgba(255,255,255,0.2); color: white; font-size: 0.7rem;">{{ eglises|length }} église(s) trouvée(s)</span>
                                    <select id="filterCategory" class="form-select form-select-sm" style="width: auto; font-size: 0.7rem; background: rgba(255,255,255,0.9); border: none;">
                                        <option value="all" selected>Tous les filtres</option>
                                        <option value="nom">Nom</option>
                                        <option value="ville">Ville</option>
                                        <option value="responsable">Pasteur</option>
                                        <option value="association">Association</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Texte d'aide -->
                        <div class="mb-1">
                            <small class="text-white-50" style="font-size: 0.65rem; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">Recherchez par nom, ville, pasteur, etc.</small>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="header-actions d-flex flex-column align-items-end">
                       
                        
                        <a href="#" class="btn btn-light btn-sm px-3 py-2 shadow border-0" id="btnVoirEglises" 
                           style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 10px; transition: all 0.3s ease; font-weight: 500; font-size: 0.85rem;" 
                           onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)';" 
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)';">
                            <i class="fas fa-eye me-1 text-primary" style="font-size: 0.8rem;"></i>
                            <span class="text-dark">Voir les Églises Entrées</span>
                        </a>
                    </div>
                </div>
                
                <!-- Décoration géométrique -->
                <div style="position: absolute; top: -50px; right: -50px; width: 150px; height: 150px; background: rgba(255,255,255,0.1); border-radius: 50%; transform: rotate(45deg);"></div>
                <div style="position: absolute; bottom: -30px; left: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.08); border-radius: 50%;"></div>
            </div>
            
            {% if eglises %}

<!-- Scripts pour les fonctionnalités d'exportation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

<script>
// JavaScript pour les boutons d'exportation
document.addEventListener('DOMContentLoaded', function() {
    // Fonction pour afficher les notifications
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `alert alert-${type === 'success' ? 'success' : 'info'} alert-dismissible fade show`;
        notification.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        notification.innerHTML = `
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'} me-2"></i>
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 3000);
    }

    // Fonction pour exporter en Excel
    document.getElementById('exportExcelBtn')?.addEventListener('click', function() {
        try {
            if (typeof XLSX === 'undefined') {
                alert('Bibliothèque XLSX non chargée. Veuillez recharger la page.');
                return;
            }
            
            const table = document.querySelector('.table-eglises');
            if (!table) {
                alert('Tableau non trouvé');
                return;
            }
            
            const wb = XLSX.utils.table_to_book(table, {sheet: 'Églises'});
            const fileName = 'Églises_enregistrées_' + new Date().toISOString().split('T')[0] + '.xlsx';
            XLSX.writeFile(wb, fileName);
            
            showNotification('Export Excel réussi !', 'success');
        } catch (error) {
            console.error('Erreur lors de l\'export Excel:', error);
            alert('Erreur lors de l\'export Excel: ' + error.message);
        }
    });
    
    // Fonction pour exporter en PDF
    document.getElementById('exportPdfBtn')?.addEventListener('click', function() {
        try {
            if (typeof window.jspdf === 'undefined') {
                alert('Bibliothèque jsPDF non chargée. Veuillez recharger la page.');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4'); // Format paysage pour plus de colonnes
            
            // Titre du document
            doc.setFontSize(16);
            doc.text('Églises Enregistrées', 14, 20);
            doc.setFontSize(10);
            doc.text('Exporté le: ' + new Date().toLocaleDateString('fr-FR'), 14, 30);
            
            const table = document.querySelector('.table-eglises');
            if (!table) {
                alert('Tableau non trouvé');
                return;
            }
            
            // Extraire les en-têtes (ignorer les icônes)
            const headers = [];
            const headerCells = table.querySelectorAll('thead th');
            headerCells.forEach(cell => {
                let headerText = cell.textContent.trim();
                headerText = headerText.replace(/[\u{1F300}-\u{1F9FF}]/gu, '').trim();
                headers.push(headerText);
            });
            
            // Extraire les données
            const data = [];
            const rows = table.querySelectorAll('tbody tr:not(.d-none)');
            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('td');
                cells.forEach((cell, index) => {
                    if (index < headers.length - 1) { // Exclure la colonne Actions
                        rowData.push(cell.textContent.trim());
                    }
                });
                if (rowData.length > 0) data.push(rowData);
            });
            
            // Générer le tableau PDF
            doc.autoTable({
                head: [headers.slice(0, -1)], // Exclure la colonne Actions
                body: data,
                startY: 40,
                styles: {
                    fontSize: 6,
                    cellPadding: 2
                },
                headStyles: {
                    fillColor: [52, 58, 64],
                    textColor: 255,
                    fontStyle: 'bold'
                },
                alternateRowStyles: {
                    fillColor: [248, 249, 250]
                }
            });
            
            const fileName = 'Églises_enregistrées_' + new Date().toISOString().split('T')[0] + '.pdf';
            doc.save(fileName);
            
            showNotification('Export PDF réussi !', 'success');
        } catch (error) {
            console.error('Erreur lors de l\'export PDF:', error);
            alert('Erreur lors de l\'export PDF: ' + error.message);
        }
    });
    
    // Fonction pour exporter en CSV
    document.getElementById('exportCsvBtn')?.addEventListener('click', function() {
        try {
            const table = document.querySelector('.table-eglises');
            if (!table) {
                alert('Tableau non trouvé');
                return;
            }
            
            let csv = [];
            
            // Extraire les en-têtes (ignorer les icônes)
            const headers = [];
            const headerCells = table.querySelectorAll('thead th');
            headerCells.forEach(cell => {
                let headerText = cell.textContent.trim();
                headerText = headerText.replace(/[\u{1F300}-\u{1F9FF}]/gu, '').trim();
                headers.push('"' + headerText.replace(/"/g, '""') + '"');
            });
            csv.push(headers.slice(0, -1).join(',')); // Exclure la colonne Actions
            
            // Extraire les données
            const rows = table.querySelectorAll('tbody tr:not(.d-none)');
            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('td');
                cells.forEach((cell, index) => {
                    if (index < headers.length - 1) { // Exclure la colonne Actions
                        rowData.push('"' + cell.textContent.trim().replace(/"/g, '""') + '"');
                    }
                });
                if (rowData.length > 0) csv.push(rowData.join(','));
            });
            
            // Créer le fichier CSV
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'Églises_enregistrées_' + new Date().toISOString().split('T')[0] + '.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Export CSV réussi !', 'success');
        } catch (error) {
            console.error('Erreur lors de l\'export CSV:', error);
            alert('Erreur lors de l\'export CSV: ' + error.message);
        }
    });
    
    // Fonction pour imprimer
    document.getElementById('printBtn')?.addEventListener('click', function() {
        try {
            const table = document.querySelector('.table-eglises');
            if (!table) {
                alert('Tableau non trouvé');
                return;
            }
            
            // Créer une nouvelle fenêtre pour l'impression
            const printWindow = window.open('', '_blank');
            
            // Contenu HTML pour l'impression
            const printContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Églises Enregistrées</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #333; text-align: center; margin-bottom: 20px; }
                        .date { text-align: center; margin-bottom: 30px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin: 0 auto; font-size: 10px; }
                        th, td { border: 1px solid #ddd; padding: 4px; text-align: left; }
                        th { background-color: #343a40; color: white; font-weight: bold; }
                        tr:nth-child(even) { background-color: #f8f9fa; }
                        @media print {
                            body { margin: 0; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>Églises Enregistrées</h1>
                    <div class="date">Imprimé le: ${new Date().toLocaleDateString('fr-FR')}</div>
                    ${table.outerHTML.replace(/<th[^>]*>Actions<\/th>/g, '').replace(/<td[^>]*class="[^"]*btn[^"]*"[^>]*>.*?<\/td>/g, '')}
                </body>
                </html>
            `;
            
            // Écrire le contenu dans la nouvelle fenêtre
            printWindow.document.write(printContent);
            printWindow.document.close();
            
            // Attendre que le contenu soit chargé puis imprimer
            printWindow.onload = function() {
                printWindow.print();
                printWindow.close();
            };
            
            showNotification('Impression lancée !', 'success');
        } catch (error) {
            console.error('Erreur lors de l\'impression:', error);
            alert('Erreur lors de l\'impression: ' + error.message);
        }
    });
    
    // Fonction pour le bouton "Voir les détails"
    document.addEventListener('click', function(e) {
        if (e.target.closest('.btn-voir-details')) {
            const button = e.target.closest('.btn-voir-details');
            const egliseId = button.getAttribute('data-id');
            const egliseNom = button.getAttribute('data-nom');
            
            // Créer et afficher la modal des détails
            showEgliseDetails(egliseId, egliseNom);
        }
    });
    
    // Fonction pour afficher les détails de l'église
    function showEgliseDetails(egliseId, egliseNom) {
        // Récupérer les données de la ligne du tableau
        const row = document.querySelector(`tr[data-id="${egliseId}"]`);
        if (!row) {
            alert('Impossible de trouver les détails de cette église.');
            return;
        }
        
        const cells = row.querySelectorAll('td');
        const details = {
            nom: cells[0]?.textContent?.trim() || '-',
            pays: cells[1]?.textContent?.trim() || '-',
            ville: cells[2]?.textContent?.trim() || '-',
            quartier: cells[3]?.textContent?.trim() || '-',
            pasteur: cells[4]?.textContent?.trim() || '-',
            telephone: cells[5]?.textContent?.trim() || '-',
            email: cells[6]?.textContent?.trim() || '-',
            dateCreation: cells[7]?.textContent?.trim() || '-',
            membres: cells[8]?.textContent?.trim() || '-',
            adresse: cells[9]?.textContent?.trim() || '-',
            association: cells[10]?.textContent?.trim() || '-',
            numeroEnreg: cells[11]?.textContent?.trim() || '-',
            dateEnreg: cells[12]?.textContent?.trim() || '-',
            activites: cells[13]?.textContent?.trim() || '-',
            autresActivites: cells[14]?.textContent?.trim() || '-'
        };
        
        // Créer le contenu HTML de la modal
        const modalHtml = `
            <div class="modal fade" id="modalDetailsEglise" tabindex="-1" aria-labelledby="modalDetailsEgliseLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header bg-info text-white">
                            <h5 class="modal-title" id="modalDetailsEgliseLabel">
                                <i class="fas fa-church me-2"></i>
                                Détails de l'église
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="card border-0 bg-light">
                                        <div class="card-body text-center">
                                            <h4 class="text-primary mb-0">${details.nom}</h4>
                                            <small class="text-muted">Nom de l'église</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-globe me-1"></i> Pays:</label>
                                        <p class="mb-0">${details.pays}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-city me-1"></i> Ville:</label>
                                        <p class="mb-0">${details.ville}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-map-marker-alt me-1"></i> Quartier:</label>
                                        <p class="mb-0">${details.quartier}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-user-tie me-1"></i> Pasteur en charge:</label>
                                        <p class="mb-0">${details.pasteur}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-phone me-1"></i> Téléphone:</label>
                                        <p class="mb-0">${details.telephone}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-envelope me-1"></i> Email:</label>
                                        <p class="mb-0">${details.email}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-calendar-alt me-1"></i> Date de fondation:</label>
                                        <p class="mb-0">${details.dateCreation}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-users me-1"></i> Nombre de membres:</label>
                                        <p class="mb-0">${details.membres}</p>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-map-marked-alt me-1"></i> Adresse complète:</label>
                                        <p class="mb-0">${details.adresse}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-building me-1"></i> Association à but non lucratif:</label>
                                        <p class="mb-0">${details.association}</p>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-id-card me-1"></i> N° d'enregistrement:</label>
                                        <p class="mb-0">${details.numeroEnreg}</p>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-calendar-check me-1"></i> Date d'enregistrement:</label>
                                        <p class="mb-0">${details.dateEnreg}</p>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-list me-1"></i> Principales activités:</label>
                                        <p class="mb-0">${details.activites}</p>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="detail-item">
                                        <label class="fw-bold text-secondary"><i class="fas fa-plus-circle me-1"></i> Autres activités:</label>
                                        <p class="mb-0">${details.autresActivites}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times me-1"></i> Fermer
                            </button>
                            <button type="button" class="btn btn-primary" onclick="window.print()">
                                <i class="fas fa-print me-1"></i> Imprimer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        // Supprimer la modal existante si elle existe
        const existingModal = document.getElementById('modalDetailsEglise');
        if (existingModal) {
            existingModal.remove();
        }
        
        // Ajouter la modal au DOM
        document.body.insertAdjacentHTML('beforeend', modalHtml);
        
        // Afficher la modal
        const modal = new bootstrap.Modal(document.getElementById('modalDetailsEglise'));
        modal.show();
        
        // Nettoyer la modal après fermeture
        document.getElementById('modalDetailsEglise').addEventListener('hidden.bs.modal', function() {
            this.remove();
        });
    }
});
</script>

                </div>
                
                <!-- Boutons d'exportation -->
                <div class="d-flex justify-content-end mb-2">
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-success btn-sm" id="exportExcelBtn" title="Exporter en Excel">
                            📊
                        </button>
                        <button type="button" class="btn btn-danger btn-sm" id="exportPdfBtn" title="Exporter en PDF">
                            📄
                        </button>
                        <button type="button" class="btn btn-info btn-sm" id="exportCsvBtn" title="Exporter en CSV">
                            📋
                        </button>
                        <button type="button" class="btn btn-primary btn-sm" id="printBtn" title="Imprimer">
                            🖨️
                        </button>
                    </div>
                </div>
                
                <div class="table-responsive" style="max-height: 150px; overflow-y: auto; overflow-x: auto; border: 1px solid #dee2e6; border-radius: 5px;">
                    <table class="table table-striped table-bordered table-hover table-eglises">
                        <thead class="table-dark">
                            <tr>
                                                                <th class="col-nom">Nom de l'Église</th>
                                <th class="col-pays">Pays</th>
                                <th class="col-ville">Ville</th>
                                <th class="col-quartier">Quartier</th>
                                <th class="col-pasteur">Pasteur en charge</th>
                                <th class="col-telephone">Téléphone</th>
                                <th class="col-email">Email</th>
                                <th class="col-date">Date de fondation</th>
                                <th class="col-membres">Membres</th>
                                <th class="col-adresse">Adresse</th>
                                <th class="col-association">A. but non lucratif</th>
                                <th class="col-numero">N° d'enregistrement</th>
                                <th class="col-date-enreg">Date d'enregistrement</th>
                                <th class="col-activites">Principales activités</th>
                                <th class="col-autres-activites">Autres activités</th>

                                <th class="col-statuts">Statuts et règlements intérieurs</th>
                                <th class="col-identite">Pièce d'identité</th>

                                <th class="col-declaration">Déclaration</th>
                                <th class="col-date-decl">Date</th>

                                <th class="col-actions">Actions</th>

                            </tr>
                        </thead>
                        <tbody>
                            {% for eglise in eglises %}
                                <tr data-id="{{ eglise.id }}">
                                    <td title="{{ eglise.nom }}">{{ eglise.nom }}</td>
                                    <td title="{{ eglise.pays|default:'Guinée' }}">{{ eglise.pays|default:"Guinée" }}</td>
                                    <td title="{{ eglise.ville }}">{{ eglise.ville }}</td>
                                    <td title="{{ eglise.quartier|default:'-' }}">{{ eglise.quartier|default:"-" }}</td>
                                    <td title="{{ eglise.responsable|default:'-' }}">{{ eglise.responsable|default:"-" }}</td>
                                    <td title="{{ eglise.telephone }}">{{ eglise.telephone }}</td>
                                    <td title="{{ eglise.email|default:'-' }}">{{ eglise.email|default:"-" }}</td>
                                    <td title="{{ eglise.date_creation|date:'d/m/Y' }}">{{ eglise.date_creation|date:"d/m/Y" }}</td>
                                    <td title="{{ eglise.nombre_membres }}">{{ eglise.nombre_membres }}</td>
                                    <td title="{{ eglise.adresse|default:'-' }}">{{ eglise.adresse|default:"-" }}</td>
                                    <td title="{{ eglise.est_association|yesno:'Oui,Non' }}">{{ eglise.est_association|yesno:"Oui,Non" }}</td>
                                    <td title="{{ eglise.numero_autorisation|default:'-' }}">{{ eglise.numero_autorisation|default:"-" }}</td>
                                    <td title="{{ eglise.date_enregistrement|date:'d/m/Y'|default:'-' }}">{{ eglise.date_enregistrement|date:"d/m/Y"|default:"-" }}</td>
                                    <td title="{{ eglise.activites|default:'-' }}">{{ eglise.activites|default:"-" }}</td>
                                    <td title="{{ eglise.autres_activites_detail|default:'-' }}">{{ eglise.autres_activites_detail|default:"-" }}</td>

                                    <td style="max-width: 200px;">
                                        {% if eglise.statuts_doc %}
                                            {% with document=eglise.statuts_doc %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".doc" or document.name|slice:"-5:" == ".docx" %}
                                                            <i class="fas fa-file-word text-primary" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% elif eglise.statuts_reglements %}
                                            {% with document=eglise.statuts_reglements %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".doc" or document.name|slice:"-5:" == ".docx" %}
                                                            <i class="fas fa-file-word text-primary" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% elif eglise.statuts %}
                                            {% with document=eglise.statuts %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".doc" or document.name|slice:"-5:" == ".docx" %}
                                                            <i class="fas fa-file-word text-primary" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% else %}
                                            <span class="text-muted">Non fourni</span>
                                        {% endif %}
                                    </td>
                                    <td style="max-width: 200px;">
                                        {% if eglise.pieces_identite_doc %}
                                            {% with document=eglise.pieces_identite_doc %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".jpg" or document.name|slice:"-5:" == ".jpeg" or document.name|slice:"-4:" == ".png" %}
                                                            <i class="fas fa-file-image text-success" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% elif eglise.piece_identite_responsable %}
                                            {% with document=eglise.piece_identite_responsable %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".jpg" or document.name|slice:"-5:" == ".jpeg" or document.name|slice:"-4:" == ".png" %}
                                                            <i class="fas fa-file-image text-success" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% elif eglise.pieces_identite %}
                                            {% with document=eglise.pieces_identite %}
                                                <div class="document-preview d-flex align-items-center gap-2">
                                                    <div class="document-icon">
                                                        {% if document.name|slice:"-4:" == ".pdf" %}
                                                            <i class="fas fa-file-pdf text-danger" style="font-size: 1.2em;"></i>
                                                        {% elif document.name|slice:"-4:" == ".jpg" or document.name|slice:"-5:" == ".jpeg" or document.name|slice:"-4:" == ".png" %}
                                                            <i class="fas fa-file-image text-success" style="font-size: 1.2em;"></i>
                                                        {% else %}
                                                            <i class="fas fa-file text-secondary" style="font-size: 1.2em;"></i>
                                                        {% endif %}
                                                    </div>
                                                    <div class="document-info flex-grow-1">
                                                        <div class="document-name" style="font-size: 0.85rem; font-weight: 500;">
                                                            {{ document.name|truncatechars:25 }}
                                                        </div>
                                                        <div class="document-actions mt-1">
                                                            <a href="{{ document.url }}" target="_blank" class="btn btn-sm btn-outline-primary me-1" title="Voir le document">
                                                                <i class="fas fa-eye"></i>
                                                            </a>
                                                            <a href="{{ document.url }}" download class="btn btn-sm btn-outline-success" title="Télécharger">
                                                                <i class="fas fa-download"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% else %}
                                            <span class="text-muted">Non fourni</span>
                                        {% endif %}
                                    </td>

                                    <td title="Déclaration complète de {{ eglise.nom_declarant|default:'-' }}" style="max-width: 300px;">
                                        <div class="declaration-complete" style="font-size: 0.85rem; line-height: 1.3;">
                                            <strong>Déclarant:</strong> {{ eglise.nom_declarant|default:"-" }}<br>
                                            <strong>Qualité:</strong> {{ eglise.qualite_declarant|default:"-" }}<br>
                                            <strong>Église:</strong> {{ eglise.nom|default:"-" }}<br>
                                            <em>"Je certifie que les informations fournies sont exactes et complètes."</em>
                                        </div>
                                    </td>
                                    <td title="{{ eglise.date_enregistrement|date:'d/m/Y'|default:eglise.date_declaration|date:'d/m/Y'|default:'-' }}">
                                        {% if eglise.date_enregistrement %}
                                            {{ eglise.date_enregistrement|date:"d/m/Y" }}
                                        {% elif eglise.date_declaration %}
                                            {{ eglise.date_declaration|date:"d/m/Y" }}
                                        {% else %}
                                            -
                                        {% endif %}
                                    </td>
                                    <td>
                                        <div class="d-flex justify-content-center gap-2">
                                             <button type="button" class="btn btn-sm btn-warning btn-modifier rounded-circle shadow-sm" data-id="{{ eglise.id }}" data-nom="{{ eglise.nom }}" title="Modifier">
                                                 <i class="fas fa-pen-fancy"></i>
                                             </button>
                                             <button type="button" class="btn btn-sm btn-danger btn-supprimer rounded-circle shadow-sm" data-id="{{ eglise.id }}" data-nom="{{ eglise.nom }}" title="Supprimer">
                                                 <i class="fas fa-trash"></i>
                                             </button>
                                         </div>
                                     </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <!-- Toast de confirmation de suppression -->
                <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
                    <div id="toastConfirmationSuppression" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">
                        <div class="toast-header bg-danger text-white">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong class="me-auto">Confirmation de suppression</strong>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-trash-alt text-danger me-2"></i>
                                <span>Supprimer l'église <strong id="nomEgliseASupprimer" class="text-danger"></strong> ?</span>
                            </div>
                            <div class="small text-muted mb-3">
                                <i class="fas fa-exclamation-circle me-1"></i> Cette action est <strong>irréversible</strong>.
                            </div>
                            <div class="d-flex justify-content-end gap-2">
                                <button type="button" id="btnAnnulerSuppression" class="btn btn-sm btn-secondary" data-bs-dismiss="toast">
                                    <i class="fas fa-times me-1"></i> Annuler
                                </button>
                                <form id="formSupprimerEglise" method="post" action="" class="m-0">
                                    {% csrf_token %}
                                    <button type="submit" id="btnConfirmerSuppression" class="btn btn-sm btn-danger">
                                        <i class="fas fa-trash-alt me-1"></i> Confirmer
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-info">
                    Aucune église n'est encore enregistrée.
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Styles CSS pour le formulaire -->
<style>
.form-section {
    background-color: transparent;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    border: none;
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
}

.form-section:hover {
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    transform: translateY(-3px);
}

.form-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 5px;
    background: linear-gradient(90deg, var(--bs-primary) 0%, var(--bs-info) 100%);
}

.section-title {
    color: #2c3e50;
    padding-bottom: 15px;
    margin-bottom: 25px;
    font-weight: 700;
    position: relative;
    display: inline-block;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, var(--bs-primary) 0%, transparent 100%);
    border-radius: 2px;
}

.section-icon {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 60px;
    height: 60px;
    border-radius: 50%;
}

.section-title i {
    color: #007bff;
    font-size: 1.5rem;
}

/* Styles améliorés pour les inputs */
.form-control {
    border-radius: 8px;
    padding: 12px 15px;
    border: 1px solid #e0e0e0;
    transition: all 0.3s ease;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.form-control:focus {
    border-color: #3498db;
    box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
}

/* Style pour les labels */
.form-label {
    font-weight: 600;
    color: #34495e;
    margin-bottom: 8px;
    font-size: 0.95rem;
}

/* Style pour les badges */
.badge {
    padding: 8px 12px;
    font-weight: 500;
    border-radius: 30px;
}

/* Style pour les boutons */
.btn {
    padding: 10px 20px;
    border-radius: 8px;
    transition: all 0.3s ease;
    font-weight: 500;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.btn-primary {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border: none;
}

.btn-success {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    border: none;
}

.btn-danger {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    border: none;
}

.btn-warning {
    background: linear-gradient(135deg, #f39c12, #d35400);
    border: none;
    color: white;
}

.btn-info {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border: none;
    color: white;
}

.form-check-container {
    display: flex;
    gap: 20px;
    margin-top: 10px;
}

.activities-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 10px;
    justify-content: flex-start;
}

.activities-grid .form-check {
    margin-bottom: 0;
    flex: 0 0 auto;
    white-space: nowrap;
    background: white;
    padding: 8px 12px;
    border-radius: 4px;
    border: 1px solid #dee2e6;
    transition: all 0.3s ease;
}

.activities-grid .form-check:hover {
    border-color: #007bff;
    box-shadow: 0 2px 4px rgba(0,123,255,0.1);
}

.activities-grid .form-check-label {
    font-size: 0.9rem;
    line-height: 1.3;
    text-align: left;
    display: inline-block;
}

.activities-grid .form-check-label i {
    font-size: 0.8rem;
    margin-right: 6px;
    width: 14px;
}

.declaration-section {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
}

.declaration-text {
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 20px;
    text-align: justify;
}

.declaration-text .form-control.d-inline-block {
    border: none;
    border-bottom: 2px solid #007bff;
    border-radius: 0;
    background: transparent;
    padding: 2px 8px;
    margin: 0 5px;
    font-weight: 600;
    color: #007bff;
    vertical-align: baseline;
    transition: all 0.3s ease;
}

.declaration-text .form-control.d-inline-block:focus {
    outline: none;
    border-bottom-color: #0056b3;
    background: rgba(0, 123, 255, 0.05);
    box-shadow: 0 2px 4px rgba(0, 123, 255, 0.2);
}

.declaration-text .form-control.d-inline-block::placeholder {
    color: #6c757d;
    font-style: italic;
    font-weight: 400;
}

.form-text.small {
    font-size: 0.7rem;
    margin-top: 2px;
}


.table-responsive {
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 20px;
}

.table-eglises {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

.table-eglises thead th {
    position: sticky;
    top: 0;
    z-index: 10;
    background-color: #343a40;
    color: white;
    font-weight: 600;
    text-align: center;
    padding: 12px 8px;
    white-space: nowrap;
}

.table-eglises tbody td {
    padding: 10px 8px;
    vertical-align: middle;
    border-top: 1px solid #dee2e6;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.table-eglises tbody tr:hover {
    background-color: rgba(0,123,255,0.1);
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    transition: all 0.2s ease;
}

.col-nom { min-width: 150px; }
.col-pays { min-width: 100px; }
.col-ville { min-width: 120px; }
.col-quartier { min-width: 120px; }
.col-pasteur { min-width: 150px; }
.col-telephone { min-width: 120px; }
.col-email { min-width: 180px; }
.col-date { min-width: 120px; }
.col-membres { min-width: 100px; }





.content-section {
    margin-bottom: 30px;
    animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.btn-primary {
    background-color: #007bff;
    border-color: #007bff;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    background-color: #0069d9;
    border-color: #0062cc;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,123,255,0.2);
}

.form-label {
    font-weight: 500;
    color: #495057;
}

.form-control:focus {
    border-color: #80bdff;
    box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
}

.error-message {
    color: #dc3545;
    font-weight: bold;
    padding: 10px;
    margin-bottom: 20px;
    border-left: 5px solid #dc3545;
    background-color: rgba(220, 53, 69, 0.1);
    border-radius: 0 4px 4px 0;
}

/* Required field asterisk styles */
.required-field::after {
    content: " *";
    color: #dc3545;
    font-weight: bold;
}
</style>

<!-- JavaScript pour le formulaire -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialiser les boutons d'action dans le tableau
    initBoutonsAction();
    
    // Initialiser les boutons du modal de confirmation
    initModalConfirmation();
    
    // Charger la liste des pasteurs pour le champ "Pasteur en charge"
    chargerListePasteurs();
    
    // Synchroniser le nom de l'église avec le champ inline
    const nomEglise = document.getElementById('nom');
    const nomEgliseInline = document.getElementById('nom_eglise_inline');
    
    // Gestion de l'affichage de la section d'association gérée plus bas
    
    // Gestion de l'affichage du champ de détails des autres activités si l'option est cochée
    // lors du rechargement du formulaire après une erreur
    if (document.getElementById('autres_activites') && document.getElementById('autres_activites').checked) {
        document.getElementById('autresActivitesDetail').style.display = 'block';
    }
    
    if (nomEglise && nomEgliseInline) {
        nomEglise.addEventListener('input', function() {
            nomEgliseInline.value = this.value;
        });
    }
    
    // Gérer l'affichage des détails d'association
    const associationOui = document.getElementById('association_oui');
    const associationNon = document.getElementById('association_non');
    const detailsAssociation = document.getElementById('detailsAssociation');
    
    // Initialiser l'affichage au chargement de la page
    if (associationOui && associationOui.checked && detailsAssociation) {
        detailsAssociation.style.display = 'block';
    } else if (detailsAssociation) {
        detailsAssociation.style.display = 'none';
    }
    
    if (associationOui && associationNon && detailsAssociation) {
        associationOui.addEventListener('change', function() {
            if (this.checked) {
                detailsAssociation.style.display = 'block';
            }
        });
        
        associationNon.addEventListener('change', function() {
            if (this.checked) {
                detailsAssociation.style.display = 'none';
            }
        });
    }
    
    // Gérer l'affichage du champ pour préciser les autres activités
    const autresActivites = document.getElementById('autres_activites');
    const autresActivitesDetail = document.getElementById('autresActivitesDetail');
    
    if (autresActivites && autresActivitesDetail) {
        autresActivites.addEventListener('change', function() {
            if (this.checked) {
                autresActivitesDetail.style.display = 'block';
            } else {
                autresActivitesDetail.style.display = 'none';
            }
        });
    }
    
    // Définir la date du jour par défaut pour la date de déclaration
    const dateDeclaration = document.getElementById('date_declaration');
    if (dateDeclaration) {
        const today = new Date().toISOString().split('T')[0];
        dateDeclaration.value = today;
    }
    
    // Gérer le bouton Annuler
    const btnAnnuler = document.getElementById('btnAnnuler');
    if (btnAnnuler) {
        btnAnnuler.addEventListener('click', function() {
            if (confirm('Êtes-vous sûr de vouloir annuler ? Toutes les données saisies seront perdues.')) {
                // Réinitialiser le formulaire
                const form = this.closest('form');
                form.reset();
                
                // Masquer les sections conditionnelles
                if (detailsAssociation) {
                    detailsAssociation.style.display = 'none';
                }
                
                if (autresActivitesDetail) {
                    autresActivitesDetail.style.display = 'none';
                }
                
                // Réinitialiser les champs inline
                if (nomEgliseInline) {
                    nomEgliseInline.value = '';
                }
                
                // Réinitialiser les autres champs inline si présents
                const nomDeclarantInline = document.getElementById('nom_declarant_inline');
                const qualiteDeclarantInline = document.getElementById('qualite_declarant_inline');
                
                if (nomDeclarantInline) {
                    nomDeclarantInline.value = '';
                }
                
                if (qualiteDeclarantInline) {
                    qualiteDeclarantInline.value = '';
                }
                
                // Réinitialiser la date de déclaration à aujourd'hui
                if (dateDeclaration) {
                    const today = new Date().toISOString().split('T')[0];
                    dateDeclaration.value = today;
                }
                
                // Faire défiler vers le haut du formulaire
                window.scrollTo({
                    top: document.querySelector('form').offsetTop - 100,
                    behavior: 'smooth'
                });
            }
        });
    }
    
    // Fonctionnalité de recherche dans le tableau
    const searchInput = document.getElementById('searchInput');
    const resultCount = document.getElementById('resultCount');
    const clearSearch = document.getElementById('clearSearch');
    const filterCategory = document.getElementById('filterCategory');
    
    // Fonction pour mettre en surbrillance le texte recherché
    function highlightText(element, searchTerm) {
        if (!searchTerm) return;
        
        const originalText = element.textContent;
        const lowerText = originalText.toLowerCase();
        const lowerSearchTerm = searchTerm.toLowerCase();
        
        if (lowerText.includes(lowerSearchTerm)) {
            const regex = new RegExp(searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
            element.innerHTML = originalText.replace(regex, match => `<mark class="bg-warning">${match}</mark>`);
        }
    }
    
    // Fonction pour réinitialiser la surbrillance
    function resetHighlights() {
        document.querySelectorAll('tbody td').forEach(cell => {
            // Conserver uniquement le texte original sans les balises de surbrillance
            if (cell.innerHTML.includes('<mark')) {
                cell.textContent = cell.textContent;
            }
        });
    }
    
    // Fonction de recherche et filtrage avec délai d'exécution
    let searchTimeout;
    function performSearch() {
        // Afficher le spinner pendant la recherche
        const searchSpinner = document.getElementById('searchSpinner');
        if (searchSpinner) searchSpinner.classList.remove('d-none');
        
        // Annuler la recherche précédente si elle est en cours
        if (searchTimeout) clearTimeout(searchTimeout);
        
        // Exécuter la recherche après un court délai pour éviter les recherches trop fréquentes
        searchTimeout = setTimeout(() => {
            resetHighlights(); // Réinitialiser les surbrillances précédentes
            
            const searchTerm = searchInput.value.toLowerCase();
            const filterValue = filterCategory.value;
            const rows = document.querySelectorAll('table tbody tr');
            let visibleCount = 0;
            
            rows.forEach(row => {
                let found = false;
                
                if (filterValue === 'all') {
                    // Rechercher dans toutes les cellules sauf la dernière (actions)
                    const cells = row.querySelectorAll('td:not(:last-child)');
                    cells.forEach(cell => {
                        if (cell.textContent.toLowerCase().includes(searchTerm)) {
                            found = true;
                            if (searchTerm) highlightText(cell, searchTerm);
                        }
                    });
                } else {
                    // Déterminer l'index de la colonne à filtrer
                    let columnIndex;
                    switch(filterValue) {
                        case 'nom': columnIndex = 0; break;
                        case 'ville': columnIndex = 2; break;
                        case 'responsable': columnIndex = 4; break;
                        case 'association': columnIndex = 8; break;
                        default: columnIndex = -1;
                    }
                    
                    if (columnIndex >= 0) {
                        const cell = row.querySelectorAll('td')[columnIndex];
                        if (cell && cell.textContent.toLowerCase().includes(searchTerm)) {
                            found = true;
                            if (searchTerm) highlightText(cell, searchTerm);
                        }
                    }
                }
                
                if (found) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            // Mettre à jour le compteur de résultats
            if (resultCount) {
                resultCount.textContent = visibleCount + ' église(s) trouvée(s)';
                
                // Changer la couleur du badge selon le nombre de résultats
                if (visibleCount === 0) {
                    resultCount.className = 'badge bg-danger';
                } else if (visibleCount < rows.length) {
                    resultCount.className = 'badge bg-warning text-dark';
                } else {
                    resultCount.className = 'badge bg-primary';
                }
            }
            
            // Masquer le spinner une fois la recherche terminée
            if (searchSpinner) searchSpinner.classList.add('d-none');
        }, 300); // Délai de 300ms pour éviter les recherches trop fréquentes
    }
    
    // Ajouter les écouteurs d'événements
    if (searchInput) {
        searchInput.addEventListener('input', performSearch);
    }
    
    if (filterCategory) {
        filterCategory.addEventListener('change', performSearch);
    }
    
    // Bouton pour effacer la recherche
    if (clearSearch) {
        clearSearch.addEventListener('click', function() {
            searchInput.value = '';
            filterCategory.value = 'all';
            performSearch();
            searchInput.focus();
        });
    }
    
    // Initialiser la recherche au chargement de la page
    // Utile si l'utilisateur revient en arrière dans le navigateur avec un terme de recherche déjà saisi
    if (searchInput && searchInput.value) {
        performSearch();
    }
    
    // Ajouter un raccourci clavier pour la recherche (Ctrl+F)
    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
            e.preventDefault(); // Empêcher le comportement par défaut du navigateur
            searchInput.focus();
        }
    });
    
    // Fonction pour confirmer la suppression d'une église
    function confirmerSuppression(egliseId, nomEglise) {
        // Fermer tous les modals ouverts
        fermerTousLesModals();
        
        // Mettre à jour le nom de l'église dans le modal
        const nomEgliseElement = document.getElementById('nomEgliseASupprimer');
        if (nomEgliseElement) {
            nomEgliseElement.textContent = nomEglise;
        }
        
        // Définir l'action du formulaire pour qu'elle pointe vers la vue de suppression
        const formSuppression = document.getElementById('formSupprimerEglise');
        formSuppression.action = "{% url 'main:supprimer_eglise' 0 %}".replace('/0/', '/' + egliseId + '/');
        
        // Afficher l'overlay de confirmation
        const overlay = document.getElementById('confirmationOverlay');
        if (overlay) {
            overlay.style.display = 'block';
        }
        
        // Afficher le modal de confirmation
        const modalConfirmationEl = document.getElementById('modalConfirmationSuppression');
        const modalConfirmation = new bootstrap.Modal(modalConfirmationEl);
        modalConfirmation.show();
        
        // Ajouter un gestionnaire d'événements pour fermer l'overlay lorsque le modal est fermé
        modalConfirmationEl.addEventListener('hidden.bs.modal', function () {
            const overlay = document.getElementById('confirmationOverlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        });
        
        // Ajouter une animation d'alerte
        const modalContent = document.querySelector('#modalConfirmationSuppression .modal-content');
        if (modalContent) {
            modalContent.classList.add('shake-animation');
            setTimeout(() => {
                modalContent.classList.remove('shake-animation');
            }, 500);
        }
        
        // Mettre le focus sur le bouton Annuler pour l'accessibilité
        setTimeout(function() {
            const btnAnnuler = document.querySelector('#modalConfirmationSuppression .btn-secondary');
            if (btnAnnuler) {
                btnAnnuler.focus();
            }
        }, 600);
    }
    
    // Initialiser les boutons d'action dans le tableau
    function initBoutonsAction() {
        // Gérer les boutons de suppression
        document.querySelectorAll('.btn-supprimer').forEach(button => {
            button.addEventListener('click', function() {
                const egliseId = this.getAttribute('data-id');
                const nomEglise = this.getAttribute('data-nom');
                confirmerSuppression(egliseId, nomEglise);
            });
        });
        
        // Gérer les boutons de visualisation
        document.querySelectorAll('.btn-voir').forEach(button => {
            button.addEventListener('click', function() {
                const egliseId = this.getAttribute('data-id');
                const nomEglise = this.getAttribute('data-nom');
                voirDetailsEglise(egliseId, nomEglise);
            });
        });
        
        // Gérer les boutons de modification
        document.querySelectorAll('.btn-modifier').forEach(button => {
            button.addEventListener('click', function() {
                const egliseId = this.getAttribute('data-id');
                const nomEglise = this.getAttribute('data-nom');
                modifierEglise(egliseId, nomEglise);
            });
        });
    }
    
    // Fonction pour voir les détails d'une église
    function voirDetailsEglise(egliseId, nomEglise) {
        // Charger les détails de l'église via AJAX
        fetch(`/get_eglise_details/${egliseId}/`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Erreur lors du chargement des détails de l'église");
                }
                return response.json();
            })
            .then(data => {
                // Afficher les détails dans un modal
                afficherModalDetailsEglise(data);
            })
            .catch(error => {
                console.error('Erreur:', error);
                // En attendant l'implémentation complète de l'API, rediriger vers la page de modification
                // qui contient déjà tous les détails de l'église
                const url = `{% url 'main:modifier_eglise' 999 %}`.replace('999', egliseId);
                window.location.href = url;
            });
    }
    
    // Fonction pour afficher les détails de l'église dans un modal
    function afficherModalDetailsEglise(eglise) {
        // Cette fonction sera utilisée lorsque l'API de détails sera implémentée
    }
    
    // Fonction pour modifier une église
    function modifierEglise(egliseId, nomEglise) {
        // Rediriger vers la page de modification de l'église
        const url = `{% url 'main:modifier_eglise' 999 %}`.replace('999', egliseId);
        window.location.href = url;
    }
    
    // Fonction pour confirmer la suppression d'une église
    function confirmerSuppression(egliseId, nomEglise) {
        // Mettre à jour le nom de l'église dans le toast
        document.getElementById('nomEgliseASupprimer').textContent = nomEglise;
        
        // Mettre à jour l'action du formulaire de suppression
        const formSuppression = document.getElementById('formSupprimerEglise');
        formSuppression.action = `{% url 'main:supprimer_eglise' 999 %}`.replace('999', egliseId);
        
        // Stocker l'ID de l'église dans un attribut data pour le bouton de confirmation
        document.getElementById('btnConfirmerSuppression').setAttribute('data-id', egliseId);
        
        // Afficher le toast de confirmation sur la barre de tâche
        const toastElement = document.getElementById('toastConfirmationSuppression');
        const toast = new bootstrap.Toast(toastElement, { autohide: false });
        toast.show();
    }
    
    // Initialiser les boutons du toast de confirmation
    function initModalConfirmation() {
        // Gérer le bouton Annuler
        const btnAnnuler = document.getElementById('btnAnnulerSuppression');
        if (btnAnnuler) {
            btnAnnuler.addEventListener('click', function() {
                // Fermer le toast (déjà géré par data-bs-dismiss="toast")
                console.log('Suppression annulée');
            });
        }
        
        // Gérer le bouton Confirmer la suppression
        const btnConfirmer = document.getElementById('btnConfirmerSuppression');
        if (btnConfirmer) {
            btnConfirmer.addEventListener('click', function(event) {
                // Ne pas empêcher la soumission par défaut
                // event.preventDefault();
                
                // Laisser le formulaire se soumettre normalement
                // Le serveur traitera la requête et supprimera l'église
                
                // Note: Si vous préférez voir un message avant la soumission, vous pouvez utiliser:
                // const egliseId = this.getAttribute('data-id');
                // const nomEglise = document.getElementById('nomEgliseASupprimer').textContent;
                // if(confirm(`Confirmer la suppression de l'église "${nomEglise}" ?`)) {
                //     document.getElementById('formSupprimerEglise').submit();
                // } else {
                //     event.preventDefault();
                // }
            });
        }
    }
    
    // Gérer le clic sur le bouton "Voir les Églises Entrées"
    const btnVoirEglises = document.getElementById('btnVoirEglises');
    if (btnVoirEglises) {
        btnVoirEglises.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Récupérer toutes les églises du tableau
            const eglisesTable = document.querySelector('table.table-eglises');
            const eglisesRows = eglisesTable.querySelectorAll('tbody tr:not(.d-none)');
            
            // Vider le corps du tableau dans le modal
            const modalTableBody = document.getElementById('eglisesEntreesTableBody');
            if (modalTableBody) {
                modalTableBody.innerHTML = '';
                
                // Remplir le tableau du modal avec les données des églises visibles
                eglisesRows.forEach(function(row) {
                    const egliseId = row.getAttribute('data-id') || '';
                    const nom = row.cells[0].textContent.trim();
                    const pays = row.cells[1].textContent.trim();
                    const ville = row.cells[2].textContent.trim();
                    const quartier = row.cells[3].textContent.trim();
                    const pasteur = row.cells[4].textContent.trim();
                    const telephone = row.cells[5].textContent.trim();
                    const email = row.cells[6].textContent.trim();
                    const date = row.cells[7].textContent.trim();
                    const membres = row.cells[8].textContent.trim();
                    const adresse = row.cells[9].textContent.trim();
                    const association = row.cells[10].textContent.trim();
                    const numero = row.cells[11].textContent.trim();
                    const dateEnreg = row.cells[12].textContent.trim();
                    const activites = row.cells[13].textContent.trim();
                    const autresActivites = row.cells[14].textContent.trim();
                    // Extraire le contenu HTML complet pour les documents
                    const statutsHTML = row.cells[15].innerHTML;
                    const identiteHTML = row.cells[16].innerHTML;
                    const declaration = row.cells[17].textContent.trim();
                    const dateDecl = row.cells[18].textContent.trim();
                    
                    // Récupérer la qualité du déclarant depuis la colonne Déclaration
                    const qualiteMatch = declaration.match(/Qualité:\s*([^\n]+)/);
                    const qualiteDeclarant = qualiteMatch ? qualiteMatch[1] : '-';
                    
                    // Initialiser la variable actionsHtml
                    let actionsHtml = '';
                    
                    // Vérifier que l'ID est valide (ni 0, ni vide, ni undefined)
                    if (egliseId && egliseId !== '0' && egliseId !== 0) {
                        actionsHtml = `
                            <div class="d-flex justify-content-center gap-2">
                                <button type="button" class="btn btn-sm btn-info btn-voir rounded-circle shadow-sm" data-id="${egliseId}" data-nom="${nom}" title="Voir les détails">
                                    <i class="fas fa-search-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-warning btn-modifier rounded-circle shadow-sm" data-id="${egliseId}" data-nom="${nom}" title="Modifier">
                                    <i class="fas fa-pen-fancy"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-danger btn-supprimer rounded-circle shadow-sm" data-id="${egliseId}" data-nom="${nom}" title="Supprimer">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    }
                    
                    // Créer une nouvelle ligne pour le tableau modal
                    const newRow = document.createElement('tr');
                    newRow.setAttribute('data-id', egliseId);
                    newRow.innerHTML = `
                        <td title="${nom}">${nom}</td>
                        <td title="${pays}">${pays}</td>
                        <td title="${ville}">${ville}</td>
                        <td title="${quartier}">${quartier}</td>
                        <td title="${pasteur}">${pasteur}</td>
                        <td title="${telephone}">${telephone}</td>
                        <td title="${email}">${email}</td>
                        <td title="${date}">${date}</td>
                        <td title="${membres}">${membres}</td>
                        <td title="${adresse}">${adresse}</td>
                        <td title="${association}">${association}</td>
                        <td title="${numero}">${numero}</td>
                        <td title="${dateEnreg}">${dateEnreg}</td>
                        <td title="${activites}">${activites}</td>
                        <td title="${autresActivites}">${autresActivites}</td>
                        <td style="max-width: 200px;">${statutsHTML}</td>
                        <td style="max-width: 200px;">${identiteHTML}</td>
                        <td title="Déclaration complète" style="max-width: 300px;">
                            <div class="declaration-complete" style="font-size: 0.85rem; line-height: 1.3;">
                                <strong>Déclarant:</strong> ${declaration.split('Déclarant:')[1] ? declaration.split('Déclarant:')[1].split('\n')[0].trim() : '-'}<br>
                                <strong>Qualité:</strong> ${qualiteDeclarant}<br>
                                <strong>Église:</strong> ${nom}<br>
                                <em>"Je certifie que les informations fournies sont exactes et complètes."</em>
                            </div>
                        </td>
                        <td title="Date de déclaration">${dateDecl}</td>
                        <td>${actionsHtml}</td>
                    `;
                    
                    modalTableBody.appendChild(newRow);
                });
                
                // Afficher le modal
                const eglisesEntreesModal = new bootstrap.Modal(document.getElementById('eglisesEntreesModal'));
                eglisesEntreesModal.show();
                
                // Initialiser les boutons d'action dans le modal
                setTimeout(() => {
                    // Réinitialiser les écouteurs d'événements pour les boutons d'action
                    document.querySelectorAll('#eglisesEntreesTableBody .btn-supprimer').forEach(button => {
                        // Supprimer les anciens écouteurs d'événements
                        const newButton = button.cloneNode(true);
                        button.parentNode.replaceChild(newButton, button);
                        
                        // Ajouter le nouvel écouteur d'événement
                        newButton.addEventListener('click', function() {
                            const egliseId = this.getAttribute('data-id');
                            const nomEglise = this.getAttribute('data-nom');
                            confirmerSuppression(egliseId, nomEglise);
                        });
                    });
                    
                    // Initialiser les boutons de visualisation
                    document.querySelectorAll('#eglisesEntreesTableBody .btn-voir').forEach(button => {
                        const newButton = button.cloneNode(true);
                        button.parentNode.replaceChild(newButton, button);
                        newButton.addEventListener('click', function() {
                            const egliseId = this.getAttribute('data-id');
                            const nomEglise = this.getAttribute('data-nom');
                            voirDetailsEglise(egliseId, nomEglise);
                        });
                    });
                    
                    // Initialiser les boutons de modification
                    document.querySelectorAll('#eglisesEntreesTableBody .btn-modifier').forEach(button => {
                        const newButton = button.cloneNode(true);
                        button.parentNode.replaceChild(newButton, button);
                        newButton.addEventListener('click', function() {
                            const egliseId = this.getAttribute('data-id');
                            const nomEglise = this.getAttribute('data-nom');
                            modifierEglise(egliseId, nomEglise);
                        });
                    });
                }, 300);
            }
        });
        }
    });
    
    // Fonction pour fermer tous les modals ouverts
    function fermerTousLesModals() {
    // Cette fonction est appelée lors de la soumission du formulaire de suppression
    // Elle s'assure que tous les modals sont fermés pour éviter les conflits
    const eglisesEntreesModalEl = document.getElementById('eglisesEntreesModal');
    if (eglisesEntreesModalEl) {
        const eglisesEntreesModal = bootstrap.Modal.getInstance(eglisesEntreesModalEl);
        if (eglisesEntreesModal) {
            eglisesEntreesModal.hide();
        }
    }
    
    const confirmationModalEl = document.getElementById('modalConfirmationSuppression');
    if (confirmationModalEl) {
        const confirmationModal = bootstrap.Modal.getInstance(confirmationModalEl);
        if (confirmationModal) {
            confirmationModal.hide();
        }
    }
    
    // Masquer l'overlay
    const overlay = document.getElementById('confirmationOverlay');
    if (overlay) {
        overlay.style.display = 'none';
    }
    
    // Laisser le formulaire se soumettre normalement
    return true;
}

// Fonction pour charger la liste des pasteurs depuis la base de données
function chargerListePasteurs() {
    const datalistPasteurs = document.getElementById('liste-pasteurs');
    if (!datalistPasteurs) return;
    
    // Essayer de récupérer les pasteurs via l'API
    fetch('/api/pasteurs/')
        .then(response => {
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des pasteurs');
            }
            return response.json();
        })
        .then(pasteurs => {
            // Ajouter les pasteurs à la liste d'autocomplétion
            pasteurs.forEach(pasteur => {
                const option = document.createElement('option');
                option.value = `${pasteur.prenom} ${pasteur.nom}`;
                datalistPasteurs.appendChild(option);
            });
        })
        .catch(error => {
            console.error('Erreur:', error);
            // En cas d'erreur, ajouter quelques pasteurs d'exemple
            datalistPasteurs.innerHTML = `
                <option value="Jean Dupont">
                <option value="Marie Martin">
                <option value="Pierre Durand">
                <option value="Sophie Lefebvre">
                <option value="Paul Bernard">
            `;
        });
}
</script>

<!-- Overlay pour le modal de confirmation -->
<div id="confirmationOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 9998;"></div>

<!-- Modal d'information -->
<div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="infoModalLabel"><i class="fas fa-info-circle"></i> Information</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="infoModalBody">
                <!-- Le contenu sera inséré dynamiquement -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal pour voir les églises entrées -->
<div class="modal fade" id="eglisesEntreesModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="eglisesEntreesModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="eglisesEntreesModalLabel"><i class="fas fa-church"></i> Liste des Églises Entrées</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="table-responsive" style="max-height: 60vh; overflow-y: auto; overflow-x: auto; scrollbar-width: thin; border: 1px solid #dee2e6; border-radius: 5px;">
                    <table class="table table-striped table-bordered table-hover table-eglises" style="width: 100%;">
                        <thead class="table-dark">
                            <tr>
                                                                <th class="col-nom">Nom de l'Église</th>
                                <th class="col-pays">Pays</th>
                                <th class="col-ville">Ville</th>
                                <th class="col-quartier">Quartier</th>
                                <th class="col-pasteur">Pasteur en charge</th>
                                <th class="col-telephone">Téléphone</th>
                                <th class="col-email">Email</th>
                                <th class="col-date">Date de fondation</th>
                                <th class="col-membres">Membres</th>
                                <th class="col-adresse">Adresse</th>
                                <th class="col-association">A. but non lucratif</th>
                                <th class="col-numero">N° d'enregistrement</th>
                                <th class="col-date-enreg">Date d'enregistrement</th>
                                <th class="col-activites">Principales activités</th>
                                <th class="col-autres-activites">Autres activités</th>

                                <th class="col-statuts">Statuts et règlements intérieurs</th>
                                <th class="col-identite">Pièce d'identité</th>

                                <th class="col-declaration">Déclaration</th>
                                <th class="col-date-decl">Date</th>

                                <th class="col-actions">Actions</th>

                            </tr>
                        </thead>
                        <tbody id="eglisesEntreesTableBody">*
                            
                            <!-- Le contenu sera inséré dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>
 
<
{% endblock %}

{% block extra_js %}
{% endblock %}
