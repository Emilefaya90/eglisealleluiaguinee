// Système de traduction automatique FR/EN
const translations = {
    fr: {
        // Navigation
        "Home": "Accueil",
        "About": "À propos",
        "History": "Historique",
        "General Objective": "Objectif général",
        "Specific Objective": "Objectif spécifique",
        "Management": "Gestion",
        "Churches": "Eglises",
        "Pastoral Staff": "Personnel Pastoral",
        "Church Members": "Membres d'Eglise",
        "Departments": "Départements",
        "Finances": "Finances",
        "News": "Actualité",
        "Events": "Événements",
        "Planning": "Planification",
        "Attendance Tracking": "Suivi des présences",
        "Reports Archiving": "Archivage des rapports",
        "Communication": "Communication",
        "Contact Us": "Contactez-nous",
        
        // Page Accueil
        "Our Gallery": "Notre Galerie",
        "Consecration": "Consécration",
        "Live Worship": "Culte en live",
        "Prayer for Pastors": "Prière pour les Pasteurs",
        "About Us": "À propos de nous",
        "Learn more": "En savoir plus",
        "Make a donation": "Faire un don",
        "Verse of the day": "Verset du jour",
        "Stay informed": "Restez informés",
        "OUR SCHEDULE": "NOTRE PROGRAMME",
        "Follow us on social media": "Suivez-nous sur nos réseaux",
        
        // Jours de la semaine
        "Monday": "Lundi",
        "Tuesday": "Mardi",
        "Wednesday": "Mercredi",
        "Thursday": "Jeudi",
        "Friday": "Vendredi",
        "Saturday": "Samedi",
        "Sunday": "Dimanche",
        
        // Programme
        "1st Choir Rehearsal": "1ère Répétition de la Chorale",
        "Bible Study": "Étude Biblique",
        "Prayer Meeting": "Rencontre de Prière",
        "Women's Meeting": "Rencontre des Femmes",
        "Intercession Group": "Groupe d'Intercession",
        "2nd Choir Rehearsal": "2ème Répétition de la Chorale",
        "Sunday Worship": "Culte du Dimanche",
        
        // Footer
        "Pentecost Hallelujah Church": "Église Pentecôte Alléluia",
        "Pentecost Hallelujah Church of Guinea": "Église Pentecôte Alléluia de Guinée",
        "The Pentecost Hallelujah Church of Guinea is a dynamic and welcoming Christian community. Founded on biblical principles, our church is committed to spreading the love of Christ.": "L'Église Pentecôte Alléluia de Guinée est une communauté chrétienne dynamique et accueillante. Fondée sur les principes bibliques, notre église s'engage à répandre l'amour du Christ.",
        "All rights reserved.": "Tous droits réservés.",
        "Legal Notice": "Mentions légales",
        "Privacy Policy": "Politique de confidentialité",
        "Terms of Use": "Conditions d'utilisation",
        
        // Newsletter
        "Subscribe to our newsletter to receive the latest news": "Inscrivez-vous à notre newsletter pour recevoir les dernières nouvelles",
        "Registration": "Inscription",
        "Newsletter Registration": "Inscription à la newsletter",
        "Full Name": "Nom complet",
        "Email Address": "Adresse email",
        "Frequency": "Fréquence",
        "Daily": "Quotidien",
        "Weekly": "Hebdomadaire",
        "Monthly": "Mensuel",
        "I agree to receive emails and I have read the": "J'accepte de recevoir des emails et j'ai lu la",
        "privacy policy": "politique de confidentialité",
        "Subscribe": "S'inscrire",
        "Thank you for subscribing!": "Merci de votre inscription!",
        "You will soon receive our next communications.": "Vous recevrez bientôt nos prochaines communications.",
        "Back to form": "Retour au formulaire",
        
        // Donation Modal
        "Make a Donation": "Faire un Don",
        "Support the work of God within the Pentecost Hallelujah Church of Guinea": "Soutenez l'œuvre de Dieu au sein de l'Eglise Pentecôte Alléluia de Guinée",
        "Thank you for your generosity!": "Merci pour votre générosité !",
        "Your donation helps support church activities and spread the Word of God.": "Votre don aide à soutenir les activités de l'église et à répandre la Parole de Dieu.",
        "Personal Information": "Informations personnelles",
        "Name": "Nom",
        "Your name": "Votre nom",
        "Email": "Email",
        "Phone": "Téléphone",
        "Church": "Église",
        "Select a church": "Sélectionnez une église",
        
        // Boutons langue
        "French": "Français",
        "English": "Anglais",
        
        // Verset
        "\"For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.\"": "\"Car Dieu a tant aimé le monde qu'il a donné son Fils unique, afin que quiconque croit en lui ne périsse point, mais qu'il ait la vie éternelle.\"",
        "John 3:16": "Jean 3:16",
        
        // Social
        "Call": "Appel",
        "Contact our Pastors": "Contactez nos Pasteurs"
    },
    en: {
        // Navigation
        "Accueil": "Home",
        "À propos": "About",
        "Historique": "History",
        "Objectif général": "General Objective",
        "Objectif spécifique": "Specific Objective",
        "Gestion": "Management",
        "Eglises": "Churches",
        "Personnel Pastoral": "Pastoral Staff",
        "Membres d'Eglise": "Church Members",
        "Départements": "Departments",
        "Finances": "Finances",
        "Actualité": "News",
        "Événements": "Events",
        "Planification": "Planning",
        "Suivi des présences": "Attendance Tracking",
        "Archivage des rapports": "Reports Archiving",
        "Communication": "Communication",
        "Contactez-nous": "Contact Us",
        
        // Page Accueil
        "Notre Galerie": "Our Gallery",
        "Consécration": "Consecration",
        "Culte en live": "Live Worship",
        "Prière pour les Pasteurs": "Prayer for Pastors",
        "À propos de nous": "About Us",
        "En savoir plus": "Learn more",
        "Faire un don": "Make a donation",
        "Verset du jour": "Verse of the day",
        "Restez informés": "Stay informed",
        "NOTRE PROGRAMME": "OUR SCHEDULE",
        "Suivez-nous sur nos réseaux": "Follow us on social media",
        
        // Jours de la semaine
        "Lundi": "Monday",
        "Mardi": "Tuesday",
        "Mercredi": "Wednesday",
        "Jeudi": "Thursday",
        "Vendredi": "Friday",
        "Samedi": "Saturday",
        "Dimanche": "Sunday",
        
        // Programme
        "1ère Répétition de la Chorale": "1st Choir Rehearsal",
        "Étude Biblique": "Bible Study",
        "Rencontre de Prière": "Prayer Meeting",
        "Rencontre des Femmes": "Women's Meeting",
        "Groupe d'Intercession": "Intercession Group",
        "2ème Répétition de la Chorale": "2nd Choir Rehearsal",
        "Culte du Dimanche": "Sunday Worship",
        
        // Footer
        "Église Pentecôte Alléluia": "Pentecost Hallelujah Church",
        "Église Pentecôte Alléluia de Guinée": "Pentecost Hallelujah Church of Guinea",
        "L'Église Pentecôte Alléluia de Guinée est une communauté chrétienne dynamique et accueillante. Fondée sur les principes bibliques, notre église s'engage à répandre l'amour du Christ.": "The Pentecost Hallelujah Church of Guinea is a dynamic and welcoming Christian community. Founded on biblical principles, our church is committed to spreading the love of Christ.",
        "Tous droits réservés.": "All rights reserved.",
        "Mentions légales": "Legal Notice",
        "Politique de confidentialité": "Privacy Policy",
        "Conditions d'utilisation": "Terms of Use",
        
        // Newsletter
        "Inscrivez-vous à notre newsletter pour recevoir les dernières nouvelles": "Subscribe to our newsletter to receive the latest news",
        "Inscription": "Registration",
        "Inscription à la newsletter": "Newsletter Registration",
        "Nom complet": "Full Name",
        "Adresse email": "Email Address",
        "Fréquence": "Frequency",
        "Quotidien": "Daily",
        "Hebdomadaire": "Weekly",
        "Mensuel": "Monthly",
        "J'accepte de recevoir des emails et j'ai lu la": "I agree to receive emails and I have read the",
        "politique de confidentialité": "privacy policy",
        "S'inscrire": "Subscribe",
        "Merci de votre inscription!": "Thank you for subscribing!",
        "Vous recevrez bientôt nos prochaines communications.": "You will soon receive our next communications.",
        "Retour au formulaire": "Back to form",
        
        // Donation Modal
        "Faire un Don": "Make a Donation",
        "Soutenez l'œuvre de Dieu au sein de l'Eglise Pentecôte Alléluia de Guinée": "Support the work of God within the Pentecost Hallelujah Church of Guinea",
        "Merci pour votre générosité !": "Thank you for your generosity!",
        "Votre don aide à soutenir les activités de l'église et à répandre la Parole de Dieu.": "Your donation helps support church activities and spread the Word of God.",
        "Informations personnelles": "Personal Information",
        "Nom": "Name",
        "Votre nom": "Your name",
        "Email": "Email",
        "Téléphone": "Phone",
        "Église": "Church",
        "Sélectionnez une église": "Select a church",
        
        // Boutons langue
        "Français": "French",
        "Anglais": "English",
        
        // Verset
        "\"Car Dieu a tant aimé le monde qu'il a donné son Fils unique, afin que quiconque croit en lui ne périsse point, mais qu'il ait la vie éternelle.\"": "\"For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.\"",
        "Jean 3:16": "John 3:16",
        
        // Social
        "Appel": "Call",
        "Contactez nos Pasteurs": "Contact our Pastors"
    }
};

// Fonction pour obtenir la langue actuelle
function getCurrentLanguage() {
    return localStorage.getItem('siteLanguage') || 'fr';
}

// Fonction pour définir la langue
function setLanguage(lang) {
    localStorage.setItem('siteLanguage', lang);
    translatePage(lang);
    updateLanguageSelector(lang);
}

// Fonction pour traduire la page
function translatePage(lang) {
    const dict = translations[lang];
    if (!dict) return;
    
    // Traduire tous les éléments avec data-translate
    document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        if (dict[key]) {
            el.textContent = dict[key];
        }
    });
    
    // Traduire les textes directement dans les éléments communs
    translateTextNodes(document.body, dict);
    
    // Mettre à jour l'attribut lang du HTML
    document.documentElement.lang = lang;
}

// Fonction pour traduire les nœuds texte
function translateTextNodes(element, dict) {
    // Liste des éléments à traduire
    const selectorsToTranslate = [
        '.nav-link',
        '.dropdown-item',
        '.gallery-caption',
        '.gallery-title',
        '.services-title',
        '.service-name',
        '.service-day span',
        '.info-card h3',
        '.info-card p',
        '.info-card a',
        '.footer-info h3',
        '.footer-info p',
        '.btn-donate',
        '.btn-subscribe',
        '.btn-text',
        'h3', 'h4', 'h5', 'h6',
        '.language-option span',
        '.form-label',
        '.form-check-label',
        '.verse-text',
        '.verse-reference',
        '.copyright',
        '.legal-links a',
        '.modal-title',
        '.success-message h5',
        '.success-message p',
        '.newsletter-header h5',
        '.social-label',
        '.phone-modal-header h3',
        'label',
        'small',
        '.lead-text',
        '.section-subtitle',
        '.devise-text',
        '.devise-subtitle'
    ];
    
    selectorsToTranslate.forEach(selector => {
        document.querySelectorAll(selector).forEach(el => {
            // Traduire le texte direct de l'élément
            el.childNodes.forEach(node => {
                if (node.nodeType === Node.TEXT_NODE) {
                    const text = node.textContent.trim();
                    if (dict[text]) {
                        node.textContent = node.textContent.replace(text, dict[text]);
                    }
                }
            });
            
            // Aussi vérifier le texte complet
            const fullText = el.textContent.trim();
            if (dict[fullText] && el.children.length === 0) {
                el.textContent = dict[fullText];
            }
        });
    });
    
    // Traduire les placeholders des inputs
    document.querySelectorAll('input[placeholder]').forEach(input => {
        const placeholder = input.getAttribute('placeholder');
        if (dict[placeholder]) {
            input.setAttribute('placeholder', dict[placeholder]);
        }
    });
    
    // Traduire les attributs title
    document.querySelectorAll('[title]').forEach(el => {
        const title = el.getAttribute('title');
        if (dict[title]) {
            el.setAttribute('title', dict[title]);
        }
    });
}

// Fonction pour mettre à jour le sélecteur de langue
function updateLanguageSelector(lang) {
    const selector = document.querySelector('#languageDropdown');
    if (selector) {
        const flagImg = selector.querySelector('img');
        const flagSpan = selector.querySelector('span');
        if (lang === 'fr') {
            if (flagImg) flagImg.src = 'https://flagcdn.com/w20/fr.png';
            if (flagSpan) flagSpan.textContent = 'FR';
        } else {
            if (flagImg) flagImg.src = 'https://flagcdn.com/w20/gb.png';
            if (flagSpan) flagSpan.textContent = 'EN';
        }
    }
}

// Initialiser au chargement de la page
document.addEventListener('DOMContentLoaded', function() {
    const currentLang = getCurrentLanguage();
    translatePage(currentLang);
    updateLanguageSelector(currentLang);
    
    // Ajouter les écouteurs d'événements pour les boutons de langue
    document.querySelectorAll('.language-option').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            const lang = this.getAttribute('data-lang') || (this.textContent.includes('Français') || this.textContent.includes('French') ? 'fr' : 'en');
            setLanguage(lang);
        });
    });
});
